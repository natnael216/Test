<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grade 9 Biology Mini App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Telegram Dark Style */
    body {
      background-color: #1e1e2d; /* Telegram-style dark */
      color: #fff;
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    ::selection {
      background: none;
    }

    html, body {
      height: 100%;
    }

    h1 {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 20px;
      color: #55acee; /* Highlight for title */
    }

    p {
      white-space: pre-wrap;
      line-height: 1.6;
      margin-top: 20px;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    #content-wrapper {
      max-width: 100%;
      padding: 0;
      margin: 0;
    }

    @media screen {
      body:after {
        content: '';
        display: block;
        position: fixed;
        top: 0; left: 0;
        width: 100vw; height: 100vh;
        pointer-events: none;
        background: rgba(0, 0, 0, 0);
        z-index: 9999;
      }
    }
  </style>
</head>
<body>
  <div id="content-wrapper">
    <h1 id="title">Initializing...</h1>
    <p id="content">Waiting for Telegram Web App data...</p>
  </div>

  <!-- Telegram Web App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <script>
    // Biology lesson topics for each deep link
    const topics = {
      "ab1": {
        title: "Unit 1: Introduction to Biology â€“ 1.1 The Meaning and Importance of Biology",
        content: `Biology is the scientific study of life or living things.
á‰£á‹®áˆŽáŒ‚ áˆ…á‹­á‹ˆá‰µ á‹ˆá‹­áˆ á‹¨áˆ…á‹­á‹ˆá‰µ á‹«áˆ‹á‰¸á‹ áŠáŒˆáˆ®á‰½ áˆ³á‹­áŠ•áˆ³á‹Š áŒ¥áŠ“á‰µ áŠá‹á¢
... (content continues exactly as you provided) ...`
      },
      "ab2": {
        title: "Unit 1: Introduction to Biology â€“ 1.2 The Methods of Studying Biology",
        content: `What is a scientific study?
(áˆ³á‹­áŠ•áˆ³á‹Š áŒ¥áŠ“á‰µ áˆ›áˆˆá‰µ áˆáŠ• áˆ›áˆˆá‰µ áŠá‹?)
... (rest of your content) ...`
      },
      "ab3": {
        title: "Unit 1: Introduction to Biology â€“ 1.3 The Branches of Biology",
        content: `What comes to your mind when you hear the word science?
... (rest of your content) ...`
      }
    };

    // Function to update page content
    function updateContent(topicKey) {
      const titleElement = document.getElementById("title");
      const contentElement = document.getElementById("content");
      const topic = topics[topicKey];

      if (topic) {
        titleElement.textContent = topic.title;
        contentElement.textContent = topic.content;
      } else {
        // Default welcome screen
        titleElement.textContent = "Welcome to Grade 9 Biology tutorials â€“ stay with us!";
        contentElement.textContent = "";
      }
    }

    // Initialization
    document.addEventListener('DOMContentLoaded', () => {
      let topicKey = null;

      if (window.Telegram && window.Telegram.WebApp) {
        window.Telegram.WebApp.ready();

        // âœ… Channel Access Check
        const allowedChannel = "@grade9_biology"; // <-- Replace with your actual channel username
        const chatUser = Telegram.WebApp.initDataUnsafe?.chat?.username;

        if (chatUser && chatUser !== allowedChannel.replace("@", "")) {
          document.body.innerHTML = `
            <div style="text-align:center; padding:50px; color:#fff;">
              <h2 style="color:#ff4c4c;">Access Denied ðŸš«</h2>
              <p>This Mini App only works when launched from our official Telegram channel: 
              <strong>${allowedChannel}</strong></p>
            </div>`;
          return; // stop loading
        }

        // Get startapp parameter
        if (Telegram.WebApp.initDataUnsafe?.start_param) {
          topicKey = Telegram.WebApp.initDataUnsafe.start_param;
        }

        Telegram.WebApp.setBackgroundColor('#1e1e2d');
        Telegram.WebApp.setHeaderColor('#1e1e2d');
      }

      // Fallback for browser testing
      if (!topicKey) {
        const urlParams = new URLSearchParams(window.location.search);
        topicKey = urlParams.get("topic");
      }

      updateContent(topicKey);
    });
  </script>
</body>
</html>
